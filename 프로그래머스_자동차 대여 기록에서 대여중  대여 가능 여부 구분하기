SELECT CAR_ID, CASE WHEN AV = 0 THEN '대여 가능' ELSE '대여중' END AS AVAILABILITY
FROM (SELECT CAR_ID,
      SUM(CASE WHEN TO_DATE('2022-10-16', 'YYYY-MM-DD')
         BETWEEN START_DATE AND END_DATE THEN 1 ELSE 0 END) AS AV
        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
      GROUP BY CAR_ID
     )
ORDER BY CAR_ID DESC

-- SELECT CAR_ID, CASE WHEN AV = 1 THEN '대여 가능' ELSE '대여중' END AS AVAILABILITY
-- FROM (SELECT CAR_ID,
--       SUM(CASE WHEN TO_DATE('2022-10-16', 'YYYY-MM-DD')
--          BETWEEN START_DATE AND END_DATE THEN 0 ELSE 1 END) AS AV  -- 0과 1이 TRUE/FALSE의 의미라 순서 바뀌면 안되는듯
--         FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
--       GROUP BY CAR_ID
--      )
-- ORDER BY CAR_ID DESC
